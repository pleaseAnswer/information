### http

#### 2. 简单讲解一下http2的多路复用

* `HTTP2`采用二进制格式传输，取代了`HTTP1.x`的文本格式，二进制格式解析更高效。
* `多路复用`代替了`HTTP1.x`的序列和阻塞机制，所有的相同域名请求都通过同一个`TCP`连接并发完成。
* 在`HTTP1.x`中，并发多个请求需要多个`TCP`连接，浏览器为了控制资源会有6-8个`TCP`连接的限制。
* `HTTP2`中同域名下所有通信都在单个连接上完成，消除了因多个`TCP`连接而带来的延 时和内存消耗。
* 单个连接上可以并行交错的请求和响应，之间互不干扰。

#### 4. A、B机器正常连接后，B机器突然重启，问A此时处于TCP什么状态？

* 因为`B`会在重启之后进入`tcp`状态机的`listen`状态，只要当`a`重新发送一个数据包（无论是`syn`包或者是应用数据），`b`端应该会主动发送一个带`rst`位的重置包来进行连接重置，所以`a`应该在`syn_sent`状态

#### 5. 介绍https握手过程

1. clientHello
2. SeverHello
3. 客户端回应
4. 服务器的最后回应

#### 6. https握手过程中，客户端如何验证证书的合法性？

1. 校验证书的颁发机构是否受客户端信任。
2. 通过`CRL`或`OCSP`的方式校验证书是否被吊销。
3. 对比系统时间，校验证书是否在有效期内。
4. 通过校验对方是否存在证书的私钥，判断证书的网站域名是否与证书颁发的域名一致。

#### 7. 介绍下HTTPS中间人攻击

* `https`协议由`http + ssl`协议构成，具体的链接过程可参考`SSL`或`TLS`握手的概述

* 中间人攻击过程如下：
  1. 服务器向客户端发送公钥。
  2. 攻击者截获公钥，保留在自己手上。
  3. 然后攻击者自己生成一个【伪造的】公钥，发给客户端。
  4. 客户端收到伪造的公钥后，生成加密`hash`值发给服务器。
  5. 攻击者获得加密`hash`值，用自己的私钥解密获得真秘钥。
  6. 同时生成假的加密`hash`值，发给服务器。
  7. 服务器用私钥解密获得假秘钥。
  8. 服务器用假秘钥加密传输信息

* 防范方法：
  * 服务端在发送浏览器的公钥中加入`CA`证书，浏览器可以验证`CA`证书的有效性

### 前端安全

#### 1. cookie和token都存放在header中，为什么不会劫持token？

1. 攻击者通过`xss`拿到用户的`cookie`然后就可以伪造`cookie`了。
2. 或者通过`csrf`在同个浏览器下面通过浏览器会自动带上`cookie`的特性
3. 在通过` 用户网站-攻击者网站-攻击者请求用户网站的方式`浏览器会自动带上cookie

* token
  1. 不会被浏览器带上，问题 2 解决
  2. `token`是放在`jwt`里面下发给客户端的 ，而且不一定存储在哪里，不能通过`document.cookie`直接拿到，通过`jwt+ip`的方式可以防止被劫持，即使被劫持也是无效的`jwt`

#### 2. 介绍下前端加密的常见场景和方法

* 首先，加密的目的，简而言之就是**将明文转换为密文**、甚至转换为其他的东西，用来隐藏明文内容本身，防止其他人直接获取到敏感明文信息、或者提高其他人获取到明文信息的难度。
* 通常我们提到加密会想到密码加密、HTTPS 等关键词，这里从场景和方法分别提一些我的个人见解。

##### 场景-密码传输

* 前端密码传输过程中如果不加密，在日志中就可以拿到用户的明文密码，对用户安全不太负责。
* 这种加密其实相对比较简单，可以使用`PlanA-前端加密`、`后端解密后计算密码字符串的MD5/MD6存入数据库`；也可以 PlanB-直接前端使
用一种稳定算法加密成唯一值、后端直接将加密结果进行 MD5/MD6，全程密
码明文不出现在程序中。
PlanA 使用 Base64 / Unicode+1 等方式加密成非明文，后端解开之后再存它的
MD5/MD6 。
PlanB 直接使用 MD5/MD6 之类的方式取 Hash ，让后端存 Hash 的 Hash 。
场景-数据包加密
应该大家有遇到过：打开一个正经网站，网站底下蹦出个不正经广告——比如
X 通的流量浮层，X 信的插入式广告……（我没有针对谁）但是这几年，我们会
发现这种广告逐渐变少了，其原因就是大家都开始采用 HTTPS 了。被人插入
这种广告的方法其实很好理解：你的网页数据包被抓取->在数据包到达你手机
之前被篡改->你得到了带网页广告的数据包->渲染到你手机屏幕。而 HTTPS 进
行了包加密，就解决了这个问题。严格来说我认为从手段上来看，它不算是一
种前端加密场景；但是从解决问题的角度来看，这确实是前端需要知道的事情。
Plan 全面采用 HTTPS
场景-展示成果加密
经常有人开发网页爬虫爬取大家辛辛苦苦一点一点发布的数据成果，有些会影
响你的竞争力，有些会降低你的知名度，甚至有些出于恶意爬取你的公开数据
后进行全量公开……比如有些食谱网站被爬掉所有食谱，站点被克隆；有些求职
网站被爬掉所有职位，被拿去卖信息；甚至有些小说漫画网站赖以生存的内容
也很容易被爬取。
Plan 将文本内容进行展示层加密，利用字体的引用特点，把拿给爬虫的数据变
成“乱码”。举个栗子：正常来讲，当我们拥有一串数字“12345”并将其放在网站
页面上的时候，其实网站页面上显示的并不是简单的数字，而是数字对应的字
体的“12345”。这时我们打乱一下字体中图形和字码的对应关系，比如我们搞成
这样：
图形：1 2 3 4 5 字码：2 3 1 5 4
这时，如果你想让用户看到“12345”，你在页面中渲染的数字就应该是“23154”。
这种手段也可以算作一种加密。
